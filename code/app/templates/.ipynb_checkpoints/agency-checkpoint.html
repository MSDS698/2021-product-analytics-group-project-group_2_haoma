{% extends "headerbase.html" %}
{% block content %}
<br><br>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
        
        <link rel="stylesheet" href="{{ url_for('static', filename='css/agency.css') }}">
        
        
        <script type="text/javascript">
            function respondRequest(requestId, status) {
              $.post("{{url_for('respond_request')}}", { request_id: requestId, status: status }, function (response) {
                location.reload();
              })
            }
        </script>
    </head>
    <body>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap.min.js"></script><br><br>
        <script src="https://cdn.datatables.net/select/1.3.3/js/dataTables.select.min.js"></script>

        <br><br>
        
            <div class="container">
                <center>
            <div class="row" style = 'width:100%; height:20%'>
                <div class="col-md-8">
                    <div class="card-body"><br><br>
                        <h1 class = 'display-4' style="font-family:Lato;font-weight:400;color:#094d41;text-align:left">Welcome {{username|title}},</h1><br><br>
                    </div>
                </div>
                <div class="col-md-4">
                    <img src="{{ url_for('static', filename='med-char.png') }}" height="100%" class="card-img-right"><br>
                </div>
                <div class="col-sm-12">
                    <div style='border-bottom:1px solid #ccc;'></div>
                </div>
            </div>
                </center></div>
        
        <center>
        <div class="container">
            <br>
            <br>
            <br>
            <table id="table1" style = "vertical-align:middle;font-family:Lato;font-weight:400;font-size:17" class="table table-hover table-striped" width="100%">
                <thead>
                    <tr>
                        {% for col_name in table_keys %}
                            <th scope="col">{{col_name}}</th>
                        {% endfor %}
                        <th></th><th></th><th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for patient in patients %}
                        <tr>
                            {% for k in table_keys %}
                                <td>{{patient[k]}}</td>
                            {% endfor %}
                            <td width="5%"><button type="button" class="btn-two green rounded small" onclick="respondRequest({{patient['request_id']}}, 'C');return false;">
                                Confirm
                            </button></td>
                            <td width="5%"><button type="button" class="btn-two red rounded small" onclick="respondRequest({{patient['request_id']}}, 'D');return false;">
                                Deny
                            </button></td>
                            <td width="5%"><button type="button" class="btn-two blue rounded small">
                                View
                            </button></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            </div></center>
    <link href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/select/1.3.3/css/select.dataTables.min.css" rel="stylesheet">
    </body>

    <script type="text/javascript">
        $(document).ready(function() {
            $('#table1').DataTable({
              responsive: true,
              "bPaginate": false,
                "bLengthChange": false,
                "bFilter": true,
                "bInfo": false,
                columnDefs: [{ 
                    orderable: false,
                    targets: [-1, -2, -3]}]
            });
          });


    </script>
        </html>
{%endblock%}